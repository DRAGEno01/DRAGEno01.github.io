<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MDT</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="modal.css">
</head>

<body>
    <div class="alert">
        <span class="closebtn">&times;</span>
        <strong>Danger!</strong> Indicates a dangerous or potentially negative action.
    </div>

    <div class="alert success" id="doneAction">
        <span class="closebtn">&times;</span>
        <strong>Done!</strong> Your report has been submitted.
    </div>

    <div class="alert info">
        <span class="closebtn">&times;</span>
        <strong>Info!</strong> Indicates a neutral informative change or action.
    </div>

    <div class="alert warning" id="onDuty">
        <span class="closebtn">&times;</span>
        <strong>Hey!</strong> Your now on duty. Don't forget to sign out after.
    </div>
    <div class="alert warning" id="offDuty">
        <span class="closebtn">&times;</span>
        <strong>Hey!</strong> Your now off duty. Thank you.
    </div>
    <div class="header">
        <h1 onclick="logout()">Anderson State MDT</h1>
    </div>
    <div class="main">
        <center>
            <br><br><br><br><br><br>
            <div class="island">
                <br>
                <h1>MDT HUB</h1>
                <br><br><br>
                <table>
                    <td>
                        <div>
                            <center>
                                <br>
                                <h3>Reports</h3>
                                <br><br>
                                <button id="trafficStopReport">New Traffic Stop Report</button><br><br>
                                <button id="sceneReport">New Scene Report</button><br><br>
                                <button id="patrolLog" onclick="patrol()">Go On/Off Patrol</button>
                                <br><br>
                            </center>
                        </div>
                    </td>
                    <td>
                        <div>
                            <center>
                                <h3>Map</h3>
                            </center>
                        </div>
                    </td>
                    <td>
                        <div>
                            <center>
                                <h3>Other</h3>
                            </center>
                        </div>
                    </td>
                </table>
            </div>
        </center>
    </div>


    <!-- The Modal -->
    <div id="sceneReportModal" class="modal">
        <!-- Modal content -->
        <div class="modal-content">
            <div class="modal-header">
                <span class="close" style="font-weight: lighter;"><i style="font-size: 20px;">Close </i> &times;</span>
                <h1>New Report</h1>
            </div>
            <div class="modal-body">
                <br>
                <table>
                    <td>
                        <h3>Main Charge</h3><input type="chargeTitle" placeholder="(Enter only 1 charge.)"
                            id="mainCrime">
                    </td>
                    <td>
                        <h3>Name of Suspect</h3><input type="suspectName" placeholder="(Enter Name)" id="suspectInfo">
                    </td>
                </table>
                <br>
                <h3>Report Information</h3>
                <textarea name="chargeInformation" id="mainTextArea" spellcheck="true"
                    placeholder="Please write a detailed report on the scene at hand."></textarea><br><br>
                <h3>Charges</h3>
                <textarea name="allcharges" id="charges" spellcheck="true"
                    placeholder="Please write ALL the charges that the suspect will get. Include the amount of jail time as well."></textarea>
                <br><br>
            </div>
            <div class="modal-footer">
                <h3>Ready to submit?</h3>
                <p>Once you do this, this action can not be undone.</p>
                <button onclick="sendSceneReport()">Send Message</button>
                <br><br>
            </div>
        </div>
    </div>


    <!-- The Modal -->
    <div id="trafficStopModal" class="modal2">
        <!-- Modal content -->
        <div class="modal-content">
            <div class="modal-header">
                <span class="close2" style="font-weight: lighter;"><i style="font-size: 20px;">Close </i> &times;</span>
                <h1>New Report</h1>
            </div>
            <div class="modal-body">
                <br>
                <table>
                    <td>
                        <h3>Reason for Stop</h3><input type="chargeTitle2" placeholder="(Enter only 1 charge.)"
                            id="mainCrime2">
                    </td>
                    <td>
                        <h3>Name of Suspect</h3><input type="suspectName2" placeholder="(Enter Name)" id="suspectInfo2">
                    </td>
                </table>
                <br>
                <h3>Report Information</h3>
                <textarea name="chargeInformation" id="mainTextArea2" spellcheck="true"
                    placeholder="Please write a detailed report on the scene at hand."></textarea><br><br>
                <h3>Additional Information + Charges</h3>
                <textarea name="allcharges" id="charges2" spellcheck="true"
                    placeholder="Please write any information that you believe should be added to the report, as well, please write ALL the charges that the suspect will get. Include the amount of jail time as well."></textarea>
                <br><br>
            </div>
            <div class="modal-footer">
                <h3>Ready to submit?</h3>
                <p>Once you do this, this action can not be undone.</p>
                <button onclick="sendTrafficReport()">Send Message</button>
                <br><br>
            </div>
        </div>
    </div>





    <script>
        function logout() {
            document.cookie = `AndersonRPstatus=signedOut; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/`
            if (document.cookie.indexOf('AndersonRPstatus=') === -1) {
                window.location.replace("../index.html")
            }
        }

        if (document.cookie.indexOf('AndersonRPstatus=') === -1) {
            window.location.replace("../index.html")
        }
    </script>

    <script>
        //let webhook = "\x68\x74\x74\x70\x73\x3A\x2F\x2F\x64\x69\x73\x63\x6F\x72\x64\x2E\x63\x6F\x6D\x2F\x61\x70\x69\x2F\x77\x65\x62\x68\x6F\x6F\x6B\x73\x2F\x31\x31\x39\x30\x32\x39\x37\x36\x37\x31\x32\x39\x30\x38\x35\x39\x36\x32\x30\x2F\x57\x5A\x5A\x59\x41\x4B\x4C\x6B\x71\x54\x76\x31\x4B\x73\x66\x64\x7A\x70\x76\x73\x79\x4B\x5F\x48\x32\x46\x5F\x6C\x4A\x6D\x42\x30\x2D\x44\x45\x63\x39\x2D\x68\x57\x57\x68\x66\x4E\x36\x4E\x6F\x63\x59\x79\x59\x38\x57\x2D\x67\x70\x68\x71\x52\x34\x72\x36\x4B\x44\x73\x66\x38\x6A"
        let sceneWebhook = "\x68\x74\x74\x70\x73\x3A\x2F\x2F\x64\x69\x73\x63\x6F\x72\x64\x2E\x63\x6F\x6D\x2F\x61\x70\x69\x2F\x77\x65\x62\x68\x6F\x6F\x6B\x73\x2F\x31\x31\x39\x30\x32\x39\x34\x36\x38\x36\x37\x37\x30\x39\x32\x39\x36\x37\x34\x2F\x6D\x4B\x79\x33\x35\x41\x31\x32\x76\x32\x52\x57\x4E\x46\x43\x74\x63\x4E\x58\x67\x6E\x76\x55\x56\x35\x4A\x79\x47\x65\x6D\x50\x57\x62\x4A\x6F\x30\x57\x64\x6E\x50\x30\x39\x5F\x54\x4A\x7A\x6E\x33\x50\x69\x58\x78\x51\x48\x75\x77\x49\x78\x61\x59\x39\x6F\x30\x4C\x6F\x43\x48\x48"
        let trafficWebhook = "\x68\x74\x74\x70\x73\x3A\x2F\x2F\x64\x69\x73\x63\x6F\x72\x64\x2E\x63\x6F\x6D\x2F\x61\x70\x69\x2F\x77\x65\x62\x68\x6F\x6F\x6B\x73\x2F\x31\x31\x39\x31\x38\x38\x32\x34\x38\x30\x30\x38\x35\x36\x33\x35\x31\x32\x32\x2F\x4A\x57\x7A\x62\x6C\x4F\x7A\x58\x50\x63\x35\x32\x6A\x4B\x33\x34\x49\x55\x2D\x67\x6C\x54\x49\x69\x4E\x56\x75\x59\x4F\x4E\x33\x58\x6E\x46\x4B\x50\x76\x4C\x33\x62\x7A\x30\x4C\x69\x72\x58\x76\x37\x75\x75\x32\x30\x77\x64\x48\x72\x32\x4F\x5F\x65\x31\x75\x4D\x49\x63\x79\x62\x5F"
        let robloxID = getCookie("AndersonRPstatus")

        function getCookie(name) {
            const value = `; ${document.cookie}`;
            const parts = value.split(`; ${name}=`);
            if (parts.length === 2) return parts.pop().split(';').shift();
        }
        console.log(robloxID)
        // const request = new XMLHttpRequest();
        // var data = request.open("GET", `https://thumbnails.roblox.com/v1/users/avatar?userIds=${robloxID}&size=720x720&format=Png&isCircular=false`)
        // var newData
        // console.log(JSON.stringify(data))




        function sendSceneReport() {
            let AuDate = new Date().toLocaleString("en-US", { timeZone: "Australia/Sydney" });

            let mainCrime = document.getElementById("mainCrime").value
            let suspectInfo = document.getElementById("suspectInfo").value
            let reportTitle = mainCrime + " - " + AuDate

            let textInput = document.getElementById("mainTextArea").value
            let charges = document.getElementById("charges").value


            const request = new XMLHttpRequest();
            const requestScene = new XMLHttpRequest();
            //request.open("POST", webhook);
            requestScene.open("POST", sceneWebhook)

            //request.setRequestHeader('Content-type', 'application/json');
            requestScene.setRequestHeader('Content-type', 'application/json')
            const params = {
                username: `New Scene Report`,
                // avatar_url: "",
                // url: `https://www.roblox.com/users/${robloxID}`,
                content: `## ${reportTitle}\n **Suspect:** *${suspectInfo}* \n\n **Report Information:** \n${textInput}\n\n **Total Charges:** \n${charges}\n\n **Officer:** \n<https://www.roblox.com/users/${robloxID}>`
            }

            //request.send(JSON.stringify(params));
            requestScene.send(JSON.stringify(params))
            document.getElementById("doneAction").style.display = "block"
            window.location.href = window.location.href
        }




        function sendTrafficReport() {
            let AuDate = new Date().toLocaleString("en-US", { timeZone: "Australia/Sydney" });

            let mainCrime2 = document.getElementById("mainCrime2").value
            let suspectInfo2 = document.getElementById("suspectInfo2").value
            let reportTitle2 = mainCrime2 + " - " + AuDate

            let textInput2 = document.getElementById("mainTextArea2").value
            let charges2 = document.getElementById("charges2").value


            const request = new XMLHttpRequest();
            const requestScene = new XMLHttpRequest();
            //request.open("POST", webhook);
            requestScene.open("POST", trafficWebhook)

            //request.setRequestHeader('Content-type', 'application/json');
            requestScene.setRequestHeader('Content-type', 'application/json')
            const params = {
                username: `New Traffic Stop Report`,
                // avatar_url: "",
                // url: `https://www.roblox.com/users/${robloxID}`,
                content: `## ${reportTitle2}\n **Suspect:** *${suspectInfo2}* \n\n **Report Information:** \n${textInput2}\n\n **Total Charges and Information:** \n${charges2}\n\n **Officer:** \n<https://www.roblox.com/users/${robloxID}>`
            }

            //request.send(JSON.stringify(params));
            requestScene.send(JSON.stringify(params))
            document.getElementById("doneAction").style.display = "block"
            window.location.href = window.location.href
        }
    </script>


    <script>
        var modal = document.getElementById("sceneReportModal");
        var btn = document.getElementById("sceneReport");
        var span = document.getElementsByClassName("close")[0];
        btn.onclick = function () {
            modal.style.display = "block";
        }
        span.onclick = function () {
            modal.style.display = "none";
        }

        var modal2 = document.getElementById("trafficStopModal");
        var btn2 = document.getElementById("trafficStopReport");
        var span2 = document.getElementsByClassName("close2")[0];
        btn2.onclick = function () {
            modal2.style.display = "block";
        }
        span2.onclick = function () {
            modal2.style.display = "none";
        }
    </script>



    <script>
        var close = document.getElementsByClassName("closebtn");
        var i;

        for (i = 0; i < close.length; i++) {
            close[i].onclick = function () {
                var div = this.parentElement;
                div.style.opacity = "0";
                setTimeout(function () { div.style.display = "none"; }, 600);
            }
        }
    </script>


    <script>
        function patrol() {
            let AuDate = new Date().toLocaleString("en-US", { timeZone: "Australia/Sydney" });
            function getCookie(name) {
                const value = `; ${document.cookie}`;
                const parts = value.split(`; ${name}=`);
                if (parts.length === 2) return parts.pop().split(';').shift();
            }
            let patrolCheck = getCookie("AndersonRPpatrol")
            if (patrolCheck === "none" || patrolCheck === undefined) {
                document.cookie = `AndersonRPpatrol=${AuDate}`
                document.getElementById("onDuty").style.display = "block"
            } else {
                const webhook = "\x68\x74\x74\x70\x73\x3A\x2F\x2F\x64\x69\x73\x63\x6F\x72\x64\x2E\x63\x6F\x6D\x2F\x61\x70\x69\x2F\x77\x65\x62\x68\x6F\x6F\x6B\x73\x2F\x31\x31\x39\x30\x32\x39\x34\x35\x35\x36\x37\x33\x34\x39\x31\x34\x36\x32\x31\x2F\x76\x72\x46\x41\x74\x70\x4B\x69\x69\x47\x57\x73\x6A\x79\x32\x31\x5F\x46\x6E\x4E\x54\x65\x68\x5A\x5A\x42\x44\x52\x67\x35\x4F\x55\x31\x6B\x71\x38\x38\x74\x77\x44\x33\x37\x6F\x2D\x51\x4F\x6F\x37\x77\x65\x6E\x50\x75\x68\x4E\x51\x76\x62\x48\x46\x69\x62\x64\x41\x56\x36\x6C\x33"
                const request = new XMLHttpRequest();
                request.open("POST", webhook);

                request.setRequestHeader('Content-type', 'application/json');
                const params = {
                    username: `New Patrol Log`,
                    // avatar_url: "",
                    // url: `https://www.roblox.com/users/${robloxID}`,
                    content: `## Partol Information \n\n **Start Time:** \n${getCookie("AndersonRPpatrol")}\n\n **End Time:** \n${AuDate}\n\n **Officer:** \n<https://www.roblox.com/users/${robloxID}>`
                }

                request.send(JSON.stringify(params));
                document.cookie = "AndersonRPpatrol=none"
                document.getElementById("offDuty").style.display = "block"
                window.location.href = window.location.href
            }
        }
    </script>
    <script>
        window.history.pushState("pageTitle", "MDT", "/?andersonmdt");
    </script>
</body>

</html>
